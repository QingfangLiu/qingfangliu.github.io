---
layout: post
title: "Revisit LCA model"
date: 2020-12-23
---

Weirdly, the Leaky, Competing Accumulator (LCA) model is my most frequently used model during graduate school, but I have never fully explored this model over the years. I have noticed that LCA is typically considered as a model with neurobiological plausibility with its leakage and lateral inhibition mechanisms. It is also useful to be generalized to multiple-alternative decision making. In this blog, however, I focus on one particular question: when considering two-alternative decision task, what kind of choice and response time data can LCA account for, while the more popular DDM cannot? For this purpose, I first need to be able to simulate data using LCA.


### Code for LCA simulation

```markdown
rlca=function(n.items, max.time, startx, drift, K, L, nu, eta, thresh, dt, tau, t0){
dt_tau = dt/tau
sqrt_dt_tau = sqrt(dt/tau)
lx = numeric(n.items)
crossed = 0

x=matrix(NA,max.time,n.items) # to store decision values
x[1,]=startx # start bias on each alternative

for(t in 2:max.time){
  sumx = sum(x[t-1,]) # get the sum for the lateral inhibition
    
# loop over items
for(i in 1:n.items){
  # calculate the lateral inhibition
  lx[i] = sumx - x[t-1,i]; # total except for itself

  temp=rnorm(1,0,eta) # white noise
  x[t,i] = x[t-1,i] +
  (drift[i] - K*x[t-1,i] - L*lx[i] - nu/(n.items-1)*sum(drift[-i]) )*dt_tau +
  temp*sqrt_dt_tau
      
  # make sure not below zero
  if(x[t,i] < 0) x[t,i] = 0

  # see if crossed thresh
  if(x[t,i] >= thresh){
  # crossed, but we want to make sure to calculate all vals
  crossed = 1
}
}
    
if(crossed == 1) break;
}
  
list("time"= t + t0, "state"=x)  
}
```


Some other implementations of LCA

- To simulate LCA with C and R
https://github.com/StevenM1/LCA

- To simulate LCA with Python
https://github.com/qihongl/pylca
